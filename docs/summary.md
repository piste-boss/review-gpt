# プロジェクトサマリー

## 会話の流れ
1. Git/GitHub 設定、ネットワーク確認、プロキシ設定など環境準備。
2. `oisoya_review` の初期 README と最初のコミットを作成し、HTTPS リモートに切り替え。
3. モバイル向け口コミルータ UI を整備し、Netlify Functions + Blobs で設定保存を実装。
4. 口コミ生成ページと `generate` 関数を追加（GAS → Gemini API で文章生成、コピー＆マップ投稿導線を提供）。
5. 管理画面に「システム設定」タブを実装し、Gemini API キーやマップリンクをブラウザから保存可能に。
6. プロンプト設定タブと生成ページ 1〜3（ライト／ミディアム／フルシティ）を導入し、各アンケートレベルと連動させる構成に拡張。
7. Instagram のデザインを参考に「サクラト。カフェ」ブランドへ刷新し、トップページ・生成ページ・管理画面の配色とコピーを統一。Netlify 本番へデプロイ済み。

## 仕様概要
- **ルータページ (`/`)**: ライト／ミディアム／フルシティの 3 ルート。AI で生成される口コミを投稿してもらう導線。ボタン押下で `/api/distribute` が設定リンクへローテーション導線。
- **管理画面 (`/admin`)**:
  - ルータ設定タブ: ボタンラベルとリンクを編集。
  - システム設定タブ: Gemini モデル名、API キー、アンケート送信先API/キー、アンケートデータ用のGAS URLを保存。
  - マップ設定タブ: Googleマップ共有リンクを管理。
  - プロンプト設定タブ: 生成ページ 1〜3 のプロンプトを個別に管理。
  - アンケート結果タブ: Google スプレッドシートの共有URLを保存（閲覧導線用メモ）。
  - QRコード作成タブ: トップページ/アンケート1〜3のQRコードをPNG/JPG・S/M/Lサイズで生成しダウンロード。
- **生成ページ**: `/generator`（ライト）、`/generator/page2`（ミディアム）、`/generator/page3`（フルシティ）。`data-prompt-key` と `data-tier` を使い、`/api/generate` が該当の GAS データとプロンプトを用いて Gemini API(v1) で文章を生成。コピー・マップ投稿導線も提供。
- **アンケートフォーム (アンケート1〜3)**: 管理画面設定を読み込み、回答送信時に設定済みの Web API へ `formKey` と回答・メタデータを POST。未設定の場合は従来どおりローカル完結で生成ページへ遷移。
- **Netlify Functions**:
  - `config`: 設定 CRUD。ラベル／リンク／AI 設定／プロンプトをまとめて管理し、Blobs に保存。
  - `distribute`: ルータボタンごとのリンクをローテーション。
  - `generate`: GAS アプリから取得したデータを Gemini API へ送り、文章生成。
  - `upload`: Blobs 動作確認用サンプル。
- **デザイン**: Noto Sans + Zen Maru Gothic、柔らかいピンク系のグラデーションを採用。「ライトカップ」「ミディアムカップ」「フルシティカップ」の表現で統一。
- **ビルド＆デプロイ**: `npm run build` → `netlify deploy --prod --dir=dist` を実行済み。Netlify 環境変数 (`NETLIFY_SITE_ID`, `NETLIFY_BLOBS_TOKEN`) を設定し、管理画面で Gemini API キー等を登録すれば運用可能。
